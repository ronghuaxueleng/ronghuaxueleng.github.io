<!DOCTYPE html>
<html>
    <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <meta name="robots" content="index, follow">
  <!-- title -->
  
    
  <title>Javascript定义类（class）的三种方法 - 白云雅阁</title>
    
  
  
  <!-- open graph -->
  <meta name="description" content="将近20年前，Javascript诞生的时候，只是一种简单的网页脚本语言。如果你忘了填写用户名，它就跳出一个警告。  如今，它变得几乎无所不能，从前端到后端，有着各种匪夷所思的用途。程序员用它完成越来越庞大的项目。 Javascript代码的复杂度也直线上升。单个网页包含10000行Javascript代码，早就司空见惯。2010年，一个工程师透露，Gmail的代码长度是443000行！  编写和">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript定义类（class）的三种方法">
<meta property="og:url" content="http://ronghuaxueleng.github.io/archives/b4e77896.html">
<meta property="og:site_name" content="白云雅阁">
<meta property="og:description" content="将近20年前，Javascript诞生的时候，只是一种简单的网页脚本语言。如果你忘了填写用户名，它就跳出一个警告。  如今，它变得几乎无所不能，从前端到后端，有着各种匪夷所思的用途。程序员用它完成越来越庞大的项目。 Javascript代码的复杂度也直线上升。单个网页包含10000行Javascript代码，早就司空见惯。2010年，一个工程师透露，Gmail的代码长度是443000行！  编写和">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ronghuaxueleng.github.io/img/javascript/bg2012070901.png">
<meta property="og:image" content="http://ronghuaxueleng.github.io/img/javascript/bg2012070902.png">
<meta property="og:image" content="http://ronghuaxueleng.github.io/img/javascript/bg2012070903.jpg">
<meta property="article:published_time" content="2016-09-19T00:00:00.000Z">
<meta property="article:modified_time" content="2025-03-09T08:43:48.270Z">
<meta property="article:author" content="ronghuaxueleng">
<meta property="article:tag" content="java 前端 php nodejs python javascript css html">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ronghuaxueleng.github.io/img/javascript/bg2012070901.png">
  <!-- canonical -->
  
  <link rel="canonical" href="http://ronghuaxueleng.github.io/archives/b4e77896.html">
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <!-- CSS -->
  
<link rel="stylesheet" href="/css/reset.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/markdown.css">

  
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 7.3.0"></head>

    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">白云雅阁</a>
    <!-- <div class="logo"><a href="/" title="Len"><img src="/img/logo.svg" alt="Len" aria-label="logo" height="20"></a></div> -->
        <ul class="nav">
            
            <li><a href="/">Home</a></li>
            
            <li><a href="/archives">Archives</a></li>
            
        </ul>


    </a>
</div>

                
                <div class="post-main">
    
        <div class="post-main-title">
            Javascript定义类（class）的三种方法
        </div>
        <div class="post-meta">
            2016-09-19 ｜ 
            
        </div>
        <!-- 圆角分类 -->
        <!-- <div class="tags"> -->
            <!--  -->
        <!-- </div> -->
        <div class="post-md">
            <p>将近20年前，<a href="http://www.ruanyifeng.com/blog/2011/06/birth_of_javascript.html">Javascript诞生</a>的时候，只是一种简单的网页脚本语言。如果你忘了填写用户名，它就跳出一个警告。</p>
<p><img src="/img/javascript/bg2012070901.png"></p>
<p>如今，它变得几乎无所不能，从前端到<a href="http://nodejs.org/">后端</a>，有着各种<a href="http://www.netmagazine.com/features/10-things-you-didnt-know-javascript-could-do">匪夷所思的用途</a>。程序员用它完成越来越庞大的项目。</p>
<p>Javascript代码的复杂度也直线上升。单个网页包含10000行Javascript代码，早就司空见惯。2010年，一个工程师<a href="http://googlesystem.blogspot.tw/2010/06/gmail-to-use-more-html5-features.html">透露</a>，Gmail的代码长度是443000行！</p>
<p><img src="/img/javascript/bg2012070902.png"></p>
<p>编写和维护如此复杂的代码，必须使用<a href="http://en.wikipedia.org/wiki/Modular_design">模块化策略</a>。目前，业界的主流做法是采用”面向对象编程”。因此，Javascript如何实现面向对象编程，就成了一个热门课题。</p>
<p>麻烦的是，Javascipt语法不支持”类”（class），导致传统的面向对象编程方法无法直接使用。程序员们做了很多探索，研究如何用Javascript模拟”类”。本文总结了Javascript定义”类”的三种方法，讨论了每种方法的特点，着重介绍了我眼中的最佳方法。</p>
<span id="more"></span>

<p><strong>Javascript定义类（class）的三种方法</strong></p>
<p>作者：阮一峰</p>
<p><img src="/img/javascript/bg2012070903.jpg"></p>
<p>在面向对象编程中，类（class）是对象（object）的模板，定义了同一组对象（又称”实例”）共有的属性和方法。</p>
<p>Javascript语言不支持”类”，但是可以用一些变通的方法，模拟出”类”。</p>
<p><strong>一、构造函数法</strong></p>
<p>这是经典方法，也是教科书必教的方法。它用构造函数模拟”类”，在其内部用this关键字指代实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Cat</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;大毛&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成实例的时候，使用new关键字。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cat1 = <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line"><span class="title function_">alert</span>(cat1.<span class="property">name</span>); <span class="comment">// 大毛</span></span><br></pre></td></tr></table></figure>
<p>类的属性和方法，还可以定义在构造函数的prototype对象之上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Cat</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">makeSound</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;喵喵喵&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于这种方法的详细介绍，请看我写的系列文章<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_encapsulation.html">《Javascript面向对象编程》</a>，这里就不多说了。它的主要缺点是，比较复杂，用到了this和prototype，编写和阅读都很费力。</p>
<p><strong>二、Object.create()法</strong></p>
<p>为了解决”构造函数法”的缺点，更方便地生成对象，Javascript的国际标准<a href="http://en.wikipedia.org/wiki/ECMAScript">ECMAScript</a>第五版（目前通行的是第三版），提出了一个新的方<br>法<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create/">Object.create()</a>。</p>
<p>用这个方法，”类”就是一个对象，不是函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Cat</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;大毛&quot;</span>,</span><br><span class="line">  <span class="attr">makeSound</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">alert</span>(<span class="string">&quot;喵喵喵&quot;</span>); &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后，直接用Object.create()生成实例，不需要用到new。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cat1 = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Cat</span>);</span><br><span class="line"><span class="title function_">alert</span>(cat1.<span class="property">name</span>); <span class="comment">// 大毛</span></span><br><span class="line">cat1.<span class="title function_">makeSound</span>(); <span class="comment">// 喵喵喵</span></span><br></pre></td></tr></table></figure>
<p>目前，各大浏览器的最新版本（包括IE9）都部署了这个方法。如果遇到老式浏览器，可以用下面的代码自行部署。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title class_">Object</span>.<span class="property">create</span>) &#123;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="property">create</span> = <span class="keyword">function</span> (<span class="params">o</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">F</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">    F.<span class="property"><span class="keyword">prototype</span></span> = o;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">F</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方法比”构造函数法”简单，但是不能实现私有属性和私有方法，实例对象之间也不能共享数据，对”类”的模拟不够全面。</p>
<p><strong>三、极简主义法</strong></p>
<p>荷兰程序员Gabor deMooij提出了一种比Object.create()更好的<a href="http://www.gabordemooij.com/articles/jsoop.html">新方法</a>，他称这种方法为”极简主义法”（minimalist approach）。这也是我推荐的方法。</p>
<p><strong>3.1 封装</strong></p>
<p>这种方法不使用this和prototype，代码部署起来非常简单，这大概也是它被叫做”极简主义法”的原因。</p>
<p>首先，它也是用一个对象模拟”类”。在这个类里面，定义一个构造函数createNew()，用来生成实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Cat</span> = &#123;</span><br><span class="line">  <span class="attr">createNew</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// some code here</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后，在createNew()里面，定义一个实例对象，把这个实例对象作为返回值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Cat</span> = &#123;</span><br><span class="line">  <span class="attr">createNew</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> cat = &#123;&#125;;</span><br><span class="line">    cat.<span class="property">name</span> = <span class="string">&quot;大毛&quot;</span>;</span><br><span class="line">    cat.<span class="property">makeSound</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">alert</span>(<span class="string">&quot;喵喵喵&quot;</span>); &#125;;</span><br><span class="line">    <span class="keyword">return</span> cat;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>使用的时候，调用createNew()方法，就可以得到实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cat1 = <span class="title class_">Cat</span>.<span class="title function_">createNew</span>();</span><br><span class="line">cat1.<span class="title function_">makeSound</span>(); <span class="comment">// 喵喵喵</span></span><br></pre></td></tr></table></figure>
<p>这种方法的好处是，容易理解，结构清晰优雅，符合传统的”面向对象编程”的构造，因此可以方便地部署下面的特性。</p>
<p><strong>3.2 继承</strong></p>
<p>让一个类继承另一个类，实现起来很方便。只要在前者的createNew()方法中，调用后者的createNew()方法即可。</p>
<p>先定义一个Animal类。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Animal</span> = &#123;</span><br><span class="line">  <span class="attr">createNew</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> animal = &#123;&#125;;</span><br><span class="line">    animal.<span class="property">sleep</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">alert</span>(<span class="string">&quot;睡懒觉&quot;</span>); &#125;;</span><br><span class="line">    <span class="keyword">return</span> animal;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后，在Cat的createNew()方法中，调用Animal的createNew()方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Cat</span> = &#123;</span><br><span class="line">  <span class="attr">createNew</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> cat = <span class="title class_">Animal</span>.<span class="title function_">createNew</span>();</span><br><span class="line">    cat.<span class="property">name</span> = <span class="string">&quot;大毛&quot;</span>;</span><br><span class="line">    cat.<span class="property">makeSound</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">alert</span>(<span class="string">&quot;喵喵喵&quot;</span>); &#125;;</span><br><span class="line">    <span class="keyword">return</span> cat;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这样得到的Cat实例，就会同时继承Cat类和Animal类。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cat1 = <span class="title class_">Cat</span>.<span class="title function_">createNew</span>();</span><br><span class="line">cat1.<span class="title function_">sleep</span>(); <span class="comment">// 睡懒觉</span></span><br></pre></td></tr></table></figure>
<p><strong>3.3 私有属性和私有方法</strong></p>
<p>在createNew()方法中，只要不是定义在cat对象上的方法和属性，都是私有的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Cat</span> = &#123;</span><br><span class="line">  <span class="attr">createNew</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> cat = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> sound = <span class="string">&quot;喵喵喵&quot;</span>;</span><br><span class="line">    cat.<span class="property">makeSound</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">alert</span>(sound); &#125;;</span><br><span class="line">    <span class="keyword">return</span> cat;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>上例的内部变量sound，外部无法读取，只有通过cat的公有方法makeSound()来读取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var cat1 = Cat.createNew();</span><br><span class="line">alert(cat1.sound); // undefined</span><br><span class="line">​```javascript</span><br><span class="line">**3.4 数据共享**</span><br><span class="line"></span><br><span class="line">有时候，我们需要所有实例对象，能够读写同一项内部数据。这个时候，只要把这个内部数据，封装在类对象的里面、createNew()方法的外面即可。</span><br><span class="line">​```javascript</span><br><span class="line">var Cat = &#123;</span><br><span class="line">  sound : &quot;喵喵喵&quot;,</span><br><span class="line">  createNew: function()&#123;</span><br><span class="line">    var cat = &#123;&#125;;</span><br><span class="line">    cat.makeSound = function()&#123; alert(Cat.sound); &#125;;</span><br><span class="line">    cat.changeSound = function(x)&#123; Cat.sound = x; &#125;;</span><br><span class="line">    return cat;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后，生成两个实例对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cat1 = <span class="title class_">Cat</span>.<span class="title function_">createNew</span>();</span><br><span class="line"><span class="keyword">var</span> cat2 = <span class="title class_">Cat</span>.<span class="title function_">createNew</span>();</span><br><span class="line">cat1.<span class="title function_">makeSound</span>(); <span class="comment">// 喵喵喵</span></span><br></pre></td></tr></table></figure>
<p>这时，如果有一个实例对象，修改了共享的数据，另一个实例对象也会受到影响。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat2.<span class="title function_">changeSound</span>(<span class="string">&quot;啦啦啦&quot;</span>);</span><br><span class="line">cat1.<span class="title function_">makeSound</span>(); <span class="comment">// 啦啦啦</span></span><br></pre></td></tr></table></figure>
<p>（完）</p>

        </div>
    
<!-- tags -->

</div>
                <div class="footer">
    <span>Copyright © <script>document.write(new Date().getFullYear())</script> 白云雅阁</span>
    <span>Powered by <a href="https://hexo.io">Hexo</a> with <a href="https:///imzl.com/zenmind">ZenMind</a></span>
    <span>备案号<a href="https://beian.miit.gov.cn/" target="_blank">京ICP备2024093046号-1</a></span>
</div>

<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>

<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>